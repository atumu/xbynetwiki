title: jpa级联操作 

#  JPA级联操作 
  *  CascadeType.PRESIST 级联持久化（保存）操作（持久保存拥有方实体时，也会持久保存该实体的所有相关数据。）
  * CascadeType.REMOVE 级联删除操作（删除一个实体时，也会删除该实体的所有相关数据。）
  *  CascadeType.MERGE 级联更新（合并）操作（将分离的实体重新合并到活动的持久性上下文时，也会合并该实体的所有相关数据。）
  * CascadeType.REFRESH 级联刷新操作 （只会查询获取操作）
  * CascadeType.ALL 包含以上全部级联操作

Refresh的作用:假如有一个条数据(就有name[值为B]和sex[值为male]两个字段),A用户取出来在进行修改操作(修改name为A),正在A修改的过程中(未提交表单),B用户也对这条数据进行修改操作(修改sex为female),B先将性别修改后提交数据库...接着A用户也提交表单,但是,此时在entityManager中的持久化实体的性别为male,没有更新为B用户修改成的female,所以此时执行一次Refresh操作,就会将该实体更新为数据库中的最新记录,然后再进行提交..做级联的时候就会将关联的实体的也获取最新的然后在更新,前提是要执行Refresh操作,CasCadeType.Refresh才会生效

Merge的作用:你要先去了解持久化实体在entityManager中的几种状态,新建,游离,托管(不是脱管),删除状态,Merge对实体进行操作时,会区分这个实体的状态,假如这个实体处于托管状态,就应该使用merge,否则会报异常..同样,做级联的时候执行merge操作,CasCadeType.Merge也会对关联实体生效

级联操作很强大，也很危险。所以，不可以盲目的崇拜和使用级联。应该根据自己的实际业务需求来选择是否需要添加对应的级联操作。

在一对多关联关系中什么时候应该使用级联的方式呢?
其实是否应该使用级联应该是个业务问题而不是个技术问题。
在一对多的级联中：
  * 如果对象之间是组合关系，使用级联；
  * 如果是聚合关系，不用级联.

首先简单说明一下组合和聚合的区别：
这两个词的来源是面向对象的分析与设计的技术中产生的。
当一个对象A是由多个其它对象（B,C,D...)组成的,如果当A不存在了，那么B,C,D...的存在就没有意义的情况下那么它们之间就是组合关系。
如果当A不存在了,B,C,D...单独存在也是有意义的情况下就是聚合关系。
 
当一个实体被删除了,那么她所对应的属性信息,方法信息的存在就没有意义了。如果当删除实体信息的时候,没有删除她的属性信息和方法信息,那么就会留下很多的孤儿-垃圾数据。所以她们之间的关系就属于组合关系。在实体映射的时候,就应该把他们配置级联。
