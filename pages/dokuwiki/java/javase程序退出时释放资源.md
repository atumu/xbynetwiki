title: javase程序退出时释放资源 

#  JavaSE程序退出时释放资源 
众所周知，Java不像C++一样，用户无法定义析构函数，也就是无法使用简单的方法实现资源自动释放。
虽然Java不需要Delete操作释放用户new出来的对象，**但是如数据库连接以及关闭文件这些操作依然需要用户手动完成。特别是单例模式定义了全局对象的时候，这样的需求也许会更加强烈。**
一个简单的程序，添加需要在应用程序结束前执行的操作，例如关闭网络连接，关闭数据库等等。
然而对于一个比较复杂的多线程应用，线程运行状态比较复杂。我们就很难预料到程序什么时候结束。如何能在应用程序结束事件到来时，处理我们要做的工作呢？
这就用到了**Java对应用程序的退出的事件出处理机制**。
**为了保证程序在结束的时候调用响应的资源释放函数**，我们可以使用` Runtime类的addShutdownHook函数 `。首先要获取到当前应用程序相关的运行时对象，使用Runtime类中的静态函数getRuntime返回当前的Runtime。
` 通过Runtime的addShutDownHook函数注册一个新的虚拟机来关闭钩子。 `
具体示例代码如下：
![](/data/dokuwiki/java/pasted/20160603-101940.png)
在上述程序中，我们可以看到通过在程序中增加` Runtime.getRuntime().addShutdownHook(new Thread()) ` 事件监听，捕获系统退出消息到来，然后，执行我们所需要完成工作，从而使我们的程序更健壮！
参考：
http://vcsos.com/article/pagesource/140421/20140421101822.shtml